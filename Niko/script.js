const LANG = {
  en: {
    hero_title: "your cozy café‑vibe discord companion",
    hero_sub: "warm, friendly, bilingual — niko brings soft vibes to your server.",
    invite: "invite niko",
    commands: "view commands",
    features_title: "what niko can do",
    feat_personality_title: "café personality system",
    feat_personality_text: "bilingual, cozy responses with personality modes like normal and café — future‑ready for more.",
    feat_music_title: "music system",
    feat_music_text: "lavalink‑powered music with café‑style messages in english and german.",
    feat_level_title: "leveling & stats",
    feat_level_text: "cozy café‑themed leveling embeds with bilingual support.",
    feat_fun_title: "fun & vibes",
    feat_fun_text: "cute animals, memes, tic‑tac‑toe, uwu‑lock and more — all personality‑aware.",
    personality_title: "personality modes",
    personality_text: "niko can speak plainly or like a soft café barista — and is ready for future moods.",
    bilingual_title: "bilingual by design",
    footer_text: "made with love by nyxen ☕",
    nav_home: "home",
    nav_tos: "tos",
    nav_privacy: "privacy",
    privacy_title: "privacy policy",
    privacy_updated: "last updated: february 24, 2026",
    privacy_sec1_title: "1. data we store",
    privacy_sec1_text: "niko stores only the data required for its features, such as:",
    privacy_sec1_list: [
      "leveling stats (xp, level, user id, guild id)",
      "configuration data (e.g., uwu‑lock settings)"
    ],
    privacy_sec2_title: "2. data we do not store",
    privacy_sec2_text: "niko does not store message content long‑term, except where technically required for a feature (e.g., temporary processing for uwu‑lock).",
    privacy_sec3_title: "3. third‑party services",
    privacy_sec3_text: "niko may call external apis (e.g., for images or memes). those services have their own privacy policies.",
    privacy_sec4_title: "4. removal of data",
    privacy_sec4_text: "if you want data related to your server removed, you can remove niko from the server or contact the developer.",
    tos_title: "terms of service",
    tos_updated: "last updated: february 24, 2026",
    tos_intro: "this page describes the terms under which you may use niko, the discord bot.",
    tos_sec1_title: "1. usage",
    tos_sec1_text: "you may invite niko to your server and use its features as provided. abuse, spam, or use in violation of discord’s terms of service is not allowed.",
    tos_sec2_title: "2. data",
    tos_sec2_text: "niko stores minimal data required for functionality (such as leveling stats or configuration). see the privacy policy for details.",
    tos_sec3_title: "3. availability",
    tos_sec3_text: "niko is provided “as is” with no guarantee of uptime or continued availability.",
    tos_sec4_title: "4. changes",
    tos_sec4_text: "these terms may be updated from time to time. continued use of niko implies acceptance of the latest version."
  },
  de: {
    hero_title: "dein gemütlicher café‑discord‑begleiter",
    hero_sub: "warm, freundlich, zweisprachig — niko bringt cozy vibes auf deinen server.",
    invite: "niko einladen",
    commands: "befehle ansehen",
    features_title: "was niko kann",
    feat_personality_title: "café‑persönlichkeitssystem",
    feat_personality_text: "zweisprachige, gemütliche antworten mit modi wie normal und café — bereit für mehr.",
    feat_music_title: "musiksystem",
    feat_music_text: "lavalink‑musik mit café‑stil nachrichten auf deutsch und englisch.",
    feat_level_title: "level & statistiken",
    feat_level_text: "gemütliche café‑level‑embeds mit zweisprachiger unterstützung.",
    feat_fun_title: "spaß & vibes",
    feat_fun_text: "süße tiere, memes, tic‑tac‑toe, uwu‑lock und mehr — alles persönlichkeitsbewusst.",
    personality_title: "persönlichkeitsmodi",
    personality_text: "niko kann neutral sprechen oder wie ein sanfter barista — und ist bereit für weitere moods.",
    bilingual_title: "von grund auf zweisprachig",
    footer_text: "mit liebe gemacht von nyxen ☕",
    nav_home: "startseite",
    nav_tos: "nutzungsbedingungen",
    nav_privacy: "datenschutz",
    privacy_title: "datenschutzerklärung",
    privacy_updated: "zuletzt aktualisiert: 24. februar 2026",
    privacy_sec1_title: "1. daten, die wir speichern",
    privacy_sec1_text: "niko speichert nur daten, die für seine funktionen erforderlich sind, wie zum beispiel:",
    privacy_sec1_list: [
      "level-statistiken (xp, level, benutzer-id, guild-id)",
      "konfigurationsdaten (z. b. uwu-lock-einstellungen)"
    ],
    privacy_sec2_title: "2. daten, die wir nicht speichern",
    privacy_sec2_text: "niko speichert nachrichteninhalte nicht langfristig, es sei denn, dies ist für eine funktion technisch erforderlich (z. b. temporäre verarbeitung für uwu-lock).",
    privacy_sec3_title: "3. drittanbieter-dienste",
    privacy_sec3_text: "niko kann externe apis aufrufen (z. b. für bilder oder memes). diese dienste haben ihre eigenen datenschutzbestimmungen.",
    privacy_sec4_title: "4. entfernung von daten",
    privacy_sec4_text: "wenn du daten im zusammenhang mit deinem server entfernen möchtest, kannst du niko vom server entfernen oder den entwickler kontaktieren.",
    tos_title: "nutzungsbedingungen",
    tos_updated: "zuletzt aktualisiert: 24. februar 2026",
    tos_intro: "diese seite beschreibt die bedingungen, unter denen du niko, den discord-bot, nutzen darfst.",
    tos_sec1_title: "1. nutzung",
    tos_sec1_text: "du kannst niko auf deinen server einladen und seine funktionen wie bereitgestellt nutzen. missbrauch, spam oder nutzung unter verstoß gegen die nutzungsbedingungen von discord ist nicht gestattet.",
    tos_sec2_title: "2. daten",
    tos_sec2_text: "niko speichert minimale daten, die für die funktionalität erforderlich sind (wie level-statistiken oder konfiguration). details findest du in der datenschutzerklärung.",
    tos_sec3_title: "3. verfügbarkeit",
    tos_sec3_text: "niko wird „wie besehen“ bereitgestellt, ohne garantie für die betriebszeit oder dauerhafte verfügbarkeit.",
    tos_sec4_title: "4. änderungen",
    tos_sec4_text: "diese bedingungen können von zeit zu zeit aktualisiert werden. die fortgesetzte nutzung von niko setzt die akzeptanz der neuesten version voraus."
  }
};

let currentLang = "en";

function safeSet(id, value) {
  const el = document.getElementById(id);
  if (el) el.textContent = value;
}

function applyLang(lang) {
  currentLang = lang;
  const t = LANG[lang];

  const fadeEls = document.querySelectorAll(".lang-fade");
  fadeEls.forEach(el => el.classList.add("hidden"));

  setTimeout(() => {
    safeSet("hero-title", t.hero_title);
    safeSet("hero-sub", t.hero_sub);
    safeSet("btn-invite", t.invite);
    safeSet("btn-commands", t.commands);

    safeSet("features-title", t.features_title);
    safeSet("feat-personality-title", t.feat_personality_title);
    safeSet("feat-personality-text", t.feat_personality_text);
    safeSet("feat-music-title", t.feat_music_title);
    safeSet("feat-music-text", t.feat_music_text);
    safeSet("feat-level-title", t.feat_level_title);
    safeSet("feat-level-text", t.feat_level_text);
    safeSet("feat-fun-title", t.feat_fun_title);
    safeSet("feat-fun-text", t.feat_fun_text);

    safeSet("personality-title", t.personality_title);
    safeSet("personality-text", t.personality_text);
    safeSet("bilingual-title", t.bilingual_title);

    safeSet("footer-text", t.footer_text);

    // Common navigation items
    safeSet("nav-home", t.nav_home);
    safeSet("nav-tos", t.nav_tos);
    safeSet("nav-privacy", t.nav_privacy);

    // Privacy Policy specific
    safeSet("privacy-title", t.privacy_title);
    safeSet("privacy-updated", t.privacy_updated);
    safeSet("privacy-section-1-title", t.privacy_sec1_title);
    safeSet("privacy-section-1-text", t.privacy_sec1_text);
    if (document.getElementById("privacy-section-1-list")) {
      const list = document.getElementById("privacy-section-1-list");
      list.innerHTML = t.privacy_sec1_list.map(item => `<li>${item}</li>`).join("");
    }
    safeSet("privacy-section-2-title", t.privacy_sec2_title);
    safeSet("privacy-section-2-text", t.privacy_sec2_text);
    safeSet("privacy-section-3-title", t.privacy_sec3_title);
    safeSet("privacy-section-3-text", t.privacy_sec3_text);
    safeSet("privacy-section-4-title", t.privacy_sec4_title);
    safeSet("privacy-section-4-text", t.privacy_sec4_text);

    // ToS specific
    safeSet("tos-title", t.tos_title);
    safeSet("tos-updated", t.tos_updated);
    safeSet("tos-intro", t.tos_intro);
    safeSet("tos-section-1-title", t.tos_sec1_title);
    safeSet("tos-section-1-text", t.tos_sec1_text);
    safeSet("tos-section-2-title", t.tos_sec2_title);
    safeSet("tos-section-2-text", t.tos_sec2_text);
    safeSet("tos-section-3-title", t.tos_sec3_title);
    safeSet("tos-section-3-text", t.tos_sec3_text);
    safeSet("tos-section-4-title", t.tos_sec4_title);
    safeSet("tos-section-4-text", t.tos_sec4_text);

    // Small delay before fading back in to ensure text has rendered
    requestAnimationFrame(() => {
      fadeEls.forEach(el => el.classList.remove("hidden"));
    });
  }, 400);

  document.querySelectorAll(".lang-toggle").forEach(btn => {
    btn.classList.toggle("active", btn.dataset.lang === lang);
  });

  localStorage.setItem("niko_lang", lang);
}

function detectLang() {
  const stored = localStorage.getItem("niko_lang");
  if (stored && LANG[stored]) return stored;
  const browser = navigator.language || navigator.userLanguage || "en";
  return browser.toLowerCase().startsWith("de") ? "de" : "en";
}

function setupLangToggle() {
  document.querySelectorAll(".lang-toggle").forEach(btn => {
    btn.addEventListener("click", () => {
      applyLang(btn.dataset.lang);
    });
  });
}

/* smooth page transitions for internal links */

function setupPageTransitions() {
  const links = document.querySelectorAll("a.link--transition");
  links.forEach(link => {
    link.addEventListener("click", e => {
      const href = link.getAttribute("href");
      if (!href || href.startsWith("http")) return;
      e.preventDefault();
      const page = document.querySelector(".page");
      page.classList.add("page--fade-out");
      setTimeout(() => {
        window.location.href = href;
      }, 450);
    });
  });
}

// Smooth scrolling
function smoothScrollTo(targetY, duration = 600) {
  const startY = window.scrollY;
  const diff = targetY - startY;
  let start;

  function step(timestamp) {
    if (!start) start = timestamp;
    const time = timestamp - start;
    const percent = Math.min(time / duration, 1);

    // soft cubic easing
    const eased = percent < 0.5
      ? 4 * percent * percent * percent
      : 1 - Math.pow(-2 * percent + 2, 3) / 2;

    window.scrollTo(0, startY + diff * eased);

    if (time < duration) requestAnimationFrame(step);
  }

  requestAnimationFrame(step);
}


document.querySelectorAll('a[href^="#"]').forEach(link => {
  link.addEventListener("click", e => {
    const target = document.querySelector(link.getAttribute("href"));
    if (!target) return;

    e.preventDefault();
    const y = target.getBoundingClientRect().top + window.scrollY - 20;
    smoothScrollTo(y, 700);
  });
});

document.addEventListener("DOMContentLoaded", () => {
  setupLangToggle();
  setupPageTransitions();
  applyLang(detectLang());
});
